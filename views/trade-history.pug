doctype html
html
	head
		meta(charset='utf-8')
		meta(name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no')
		link(rel='stylesheet' href='/css/bootstrap.min.css')
		style.
			.trade-card {
				border: 1px solid #ddd;
				border-radius: 8px;
				margin-bottom: 1rem;
				padding: 1rem;
				background: #fafafa;
			}
			.trade-header {
				font-weight: bold;
				font-size: 1.1rem;
				border-bottom: 1px solid #eee;
				padding-bottom: 0.5rem;
				margin-bottom: 0.75rem;
			}
			.trade-date {
				color: #666;
				font-weight: normal;
				font-size: 0.9rem;
			}
			.party {
				margin-bottom: 0.75rem;
			}
			.party-name {
				font-weight: 600;
			}
			.asset-list {
				margin: 0.25rem 0 0 1.5rem;
				padding: 0;
				list-style: disc;
			}
			.asset-list li {
				margin-bottom: 0.15rem;
			}
			.asset-list li:last-child {
				margin-bottom: 0;
			}
			.asset-note {
				font-size: 0.75rem;
				color: #888;
				font-style: italic;
			}
			.trade-notes {
				font-style: italic;
				color: #666;
				font-size: 0.85rem;
				margin-top: 0.5rem;
			}
		title Trade History

	body
		div.container.py-4
			if singleTrade
				p.mb-2
					a(href="/trades") ← All Trades
				h1.mb-4 Trade ##{tradeNumber}
			else
				h1.mb-4 Trade History

			each trade in trades
				div.trade-card(id="trade-" + trade.number)
					div.trade-header
						if singleTrade
							| Trade ##{trade.number}
						else
							a(href="/trades/" + trade.number style="color: inherit; text-decoration: none;") Trade ##{trade.number}
						span.trade-date.ml-3 #{trade.timestamp.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })}
					
					each party in trade.parties
						div.party
							span.party-name #{party.franchiseName}
							if party.usePlural
								|  receive:
							else
								|  receives:
							ul.asset-list
								each asset in party.assets
									li
										div #{asset.display}
										if asset.notes && asset.notes.length > 0
											each note in asset.notes
												if note.type === 'chain'
													div.asset-note
														each item, idx in note.items
															if idx > 0
																if item.type === 'outcome'
																	|  → 
																else
																	|  #{note.separator} 
															if item.type === 'outcome'
																| #{item.text}
															else if item.isCurrent
																strong ##{item.tradeNumber}
															else
																a(href="/trades/" + item.tradeNumber) ##{item.tradeNumber}
												else if note.type === 'outcome'
													div.asset-note → #{note.text}
					
					if trade.notes
						div.trade-notes #{trade.notes}
